# go.netflow

This is a work-in-progress NetFlow v9 (RFC 3954) collector in Go.

## Installation

```
go get github.com/brooksbp/go.netflow
```

## Usage

```
cd $GOPATH/src/github.com/brooksbp/go.netflow/collector
go build

./collector
LAST_SWITCHED: 1647021790 FIRST_SWITCHED: 1647021790 IN_PKTS: 6 IN_BYTES: 4461 INPUT_SNMP: 13 OUTPUT_SNMP: 2
IPV4_SRC_ADDR: [kale.] (192.168.88.21) IPV4_DST_ADDR: [yh-in-f93.1e100.net.] (74.125.137.93) PROTOCOL: UDP SRC_TOS: 0
L4_SRC_PORT: 57506 L4_DST_PORT: QUIC IPV4_NEXT_HOP: [cpe-174-109-056-001.nc.res.rr.com.] (174.109.56.1) DST_MASK: 0 SRC_MASK: 0 TCP_FLAGS: 0
IN_DST_MAC: d4:ca:6d:84:30:8a OUT_SRC_MAC: d4:ca:6d:84:30:89

LAST_SWITCHED: 1647021820 FIRST_SWITCHED: 1647021820 IN_PKTS: 4 IN_BYTES: 3217 INPUT_SNMP: 2 OUTPUT_SNMP: 13
IPV4_SRC_ADDR: [yh-in-f93.1e100.net.] (74.125.137.93) IPV4_DST_ADDR: [kale.] (192.168.88.21) PROTOCOL: UDP SRC_TOS: 0
L4_SRC_PORT: QUIC L4_DST_PORT: 57506 IPV4_NEXT_HOP: [kale.] (192.168.88.21) DST_MASK: 0 SRC_MASK: 0 TCP_FLAGS: 0
IN_DST_MAC: d4:ca:6d:84:30:89 OUT_SRC_MAC: d4:ca:6d:84:30:8a

LAST_SWITCHED: 1647022000 FIRST_SWITCHED: 1647022000 IN_PKTS: 2 IN_BYTES: 524 INPUT_SNMP: 2 OUTPUT_SNMP: 0
IPV4_SRC_ADDR: [dns-cac-lb-01.rr.com.] (209.18.47.61) IPV4_DST_ADDR: [cpe-174-109-060-172.nc.res.rr.com.] (174.109.60.172) PROTOCOL: UDP SRC_TOS: 0
L4_SRC_PORT: DNS L4_DST_PORT: 36470 IPV4_NEXT_HOP: [cpe-174-109-060-172.nc.res.rr.com.] (174.109.60.172) DST_MASK: 0 SRC_MASK: 0 TCP_FLAGS: 0
IN_DST_MAC: d4:ca:6d:84:30:89 OUT_SRC_MAC: 00:00:00:00:00:00

LAST_SWITCHED: 1647024450 FIRST_SWITCHED: 1647024450 IN_PKTS: 9 IN_BYTES: 6468 INPUT_SNMP: 2 OUTPUT_SNMP: 13
IPV4_SRC_ADDR: [ec2-54-225-167-45.compute-1.amazonaws.com.] (54.225.167.45) IPV4_DST_ADDR: [kale.] (192.168.88.21) PROTOCOL: TCP SRC_TOS: 0
L4_SRC_PORT: HTTPS L4_DST_PORT: 51112 IPV4_NEXT_HOP: [kale.] (192.168.88.21) DST_MASK: 0 SRC_MASK: 0 TCP_FLAGS: 18
IN_DST_MAC: d4:ca:6d:84:30:89 OUT_SRC_MAC: d4:ca:6d:84:30:8a

LAST_SWITCHED: 1647580540 FIRST_SWITCHED: 1647560450 IN_PKTS: 12 IN_BYTES: 981 INPUT_SNMP: 13 OUTPUT_SNMP: 2
IPV4_SRC_ADDR: [kale.] (192.168.88.21) IPV4_DST_ADDR: [github.com.] (192.30.252.129) PROTOCOL: TCP SRC_TOS: 0
L4_SRC_PORT: 46995 L4_DST_PORT: HTTPS IPV4_NEXT_HOP: [cpe-174-109-056-001.nc.res.rr.com.] (174.109.56.1) DST_MASK: 0 SRC_MASK: 0 TCP_FLAGS: 2
IN_DST_MAC: d4:ca:6d:84:30:8a OUT_SRC_MAC: d4:ca:6d:84:30:89
..
```
